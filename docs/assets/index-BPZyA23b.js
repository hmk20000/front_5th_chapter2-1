(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();const i={cart:"장바구니",addToCart:"추가",removeItem:"삭제",luckySale:t=>`번개세일! ${t}이(가) 20% 할인 중입니다!`,suggestSale:t=>`${t}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`,totalPrice:t=>`총액: ${t}원`,discountRate:t=>`(${t}% 할인 적용)`,points:t=>`(포인트: ${t})`,stockStatus:(t,n)=>`${t}: ${n>0?`재고 부족 (${n}개 남음)`:"품절"}
`,cartItem:(t,n,e)=>`${t} - ${n}원 x ${e}`,outOfStock:"재고가 부족합니다.",error:{tagNameRequired:"tagName is required"}},m={TICK_TIME:1e3,LUCKY_SALE_INTERVAL:30,SUGGEST_SALE_INTERVAL:60,LUCKY_SALE_RATE:.3,LUCKY_SALE_DISCOUNT_RATE:.8,SUGGEST_SALE_DISCOUNT_RATE:.95},c=(t,n)=>{if(!t)throw new Error(i.error.tagNameRequired);const e=document.createElement(t),{parent:a,...o}=n;return Object.entries(o).forEach(([s,r])=>{s==="dataset"?Object.entries(r).forEach(([l,u])=>{e.dataset[l]=u}):e[s]=r}),a&&a.appendChild(e),e},d=[{id:"p1",name:"상품1",price:1e4,quantity:50,discountRate:.1},{id:"p2",name:"상품2",price:2e4,quantity:30,discountRate:.15},{id:"p3",name:"상품3",price:3e4,quantity:20,discountRate:.2},{id:"p4",name:"상품4",price:15e3,quantity:0,discountRate:.05},{id:"p5",name:"상품5",price:25e3,quantity:10,discountRate:.25}],x=t=>{const n=c("div",{className:"bg-gray-100 p-8",parent:t}),e=c("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",parent:n});c("h1",{className:"text-2xl font-bold mb-4",textContent:i.cart,parent:e}),c("div",{id:"cart-items",parent:e}),c("div",{className:"text-xl font-bold my-4",id:"cart-total",parent:e}),c("select",{className:"border rounded p-2 mr-2",id:"product-select",parent:e}),c("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",id:"add-to-cart",textContent:i.addToCart,parent:e}),c("div",{className:"text-sm text-gray-500 mt-2",id:"stock-status",parent:e})},C=t=>{const n=document.getElementById("cart-items"),e=c("div",{id:t.id,className:"flex justify-between items-center mb-2",parent:n});c("span",{textContent:i.cartItem(t.name,t.price,1),parent:e});const a=c("div",{parent:e}),o="text-white px-2 py-1 rounded";c("button",{className:`quantity-change bg-blue-500 ${o} mr-1`,parent:a,textContent:"-",dataset:{productId:t.id,change:-1}}),c("button",{className:`quantity-change bg-blue-500 ${o} mr-1`,parent:a,textContent:"+",dataset:{productId:t.id,change:1}}),c("button",{className:`remove-item bg-red-500 ${o}`,parent:a,textContent:i.removeItem,dataset:{productId:t.id}})},f=t=>{const n=document.getElementById("product-select");n.innerHTML="",t.forEach(e=>{c("option",{value:e.id,textContent:e.name+" - "+e.price+"원",parent:n,disabled:e.quantity===0})})},h=(t,n)=>{const e=document.getElementById("cart-total");e.textContent=i.totalPrice(Math.round(n)),t>0&&c("span",{className:"text-green-500 ml-2",textContent:i.discountRate((t*100).toFixed(1)),parent:e}),q(d),L(e,n)},L=(t,n)=>{let e=Math.floor(n/1e3),a=document.getElementById("loyalty-points");a||(a=c("span",{id:"loyalty-points",className:"text-blue-500 ml-2",parent:t})),a.textContent=i.points(e)},q=t=>{const n=document.getElementById("stock-status");let e="";t.forEach(a=>{a.quantity<5&&(e+=i.stockStatus(a.name,a.quantity))}),n.textContent=e},y={lastSelectedProductId:null},$=()=>{let t=0;const n=Math.random()*10,e=Math.random()*20;setInterval(()=>{t++,n<t&&t%m.LUCKY_SALE_INTERVAL===0&&b(),e<t&&t%m.SUGGEST_SALE_INTERVAL===0&&T()},m.TICK_TIME)},b=()=>{const t=d[Math.floor(Math.random()*d.length)];Math.random()<m.LUCKY_SALE_RATE&&t.quantity>0&&(t.price=Math.round(t.price*m.LUCKY_SALE_DISCOUNT_RATE),alert(i.luckySale(t.name)),f(d))},T=()=>{if(!y.lastSelectedProductId)return;const t=d.find(n=>n.id!==y.lastSelectedProductId&&n.quantity>0);t&&(alert(i.suggestSale(t.name)),t.price=Math.round(t.price*m.SUGGEST_SALE_DISCOUNT_RATE),f(t))},S=t=>{let n=0,e=0,a=0;const s=document.getElementById("cart-items").children;for(let l=0;l<s.length;l++){const u=t.find(E=>E.id===s[l].id),p=parseInt(s[l].querySelector("span").textContent.split("x ")[1]);a+=p;const g=u.price*p;n+=g;const I=p>=10?u.discountRate:0;e+=g*(1-I)}let r=0;if(a>=30){const l=e*.25,u=n-e;l>u?(e=n*(1-.25),r=.25):r=(n-e)/n}else r=(n-e)/n;new Date().getDay()===2&&(e*=1-.1,r=Math.max(r,.1)),h(r,e)},N=()=>{const n=document.getElementById("product-select").value,e=d.find(a=>a.id===n);if(e&&e.quantity>0){const a=document.getElementById(e.id);if(a){const o=parseInt(a.querySelector("span").textContent.split("x ")[1])+1;o<=e.quantity?(a.querySelector("span").textContent=i.cartItem(e.name,e.price,o),e.quantity--):alert(i.outOfStock)}else C(e),e.quantity--;S(d),y.lastSelectedProductId=n}},_=t=>{const n=t.target;if(n.classList.contains("quantity-change")||n.classList.contains("remove-item")){const e=n.dataset.productId,a=document.getElementById(e),o=d.find(s=>s.id===e);if(n.classList.contains("quantity-change")){const s=parseInt(n.dataset.change),r=parseInt(a.querySelector("span").textContent.split("x ")[1])+s;r>0&&r<=o.quantity+parseInt(a.querySelector("span").textContent.split("x ")[1])?(a.querySelector("span").textContent=a.querySelector("span").textContent.split("x ")[0]+"x "+r,o.quantity-=s):r<=0?(a.remove(),o.quantity-=s):alert(i.outOfStock)}else if(n.classList.contains("remove-item")){const s=parseInt(a.querySelector("span").textContent.split("x ")[1]);o.quantity+=s,a.remove()}S(d)}};x(document.getElementById("app")),f(d),S(d),$(),document.getElementById("add-to-cart").addEventListener("click",N),document.getElementById("cart-items").addEventListener("click",_);
